version: "2"
services:
  base-master:
     image: rahonabe/icinga2-base-master
     env_file: ./secrets.env
     links:
        - sql
     domainname: rahona.be
     hostname: icinga2-master
     build: 
      context: ./base-master
     ports:
       - 5665:5665
     volumes:
       - ./icinga2-master/cache:/var/cache/icinga2
       - ./icinga2-master/certs:/etc/apache2/ssl:ro
       - ./icinga2-master/etc/icinga2:/etc/icinga2
       - ./icinga2-master/lib/icinga2:/var/lib/icinga2
       - ./icinga2-master/lib/php5/sessions:/var/lib/php5/sessions
       - ./icinga2-master/log/apache2:/var/log/apache2
       - ./icinga2-master/log/icinga2:/var/log/icinga2
  sql:
    image: mariadb
    env_file: ./secrets.env
    domainname: rahona.be
    hostname: icinga2-sql
    restart: always
    volumes:
      - ./icinga2-sql/lib/mysql:/var/lib/mysql
      - ./icinga2-sql/log/mysql:/var/log/mysql
